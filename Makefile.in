# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

@SET_MAKE@

prefix      = @prefix@
exec_prefix = @exec_prefix@
libdir      = @libdir@
sbindir     = @sbindir@

HOST_CPU = @HOST_CPU@
HOST_OS  = @HOST_OS@

CC       = @CC@
CFLAGS   = @CFLAGS@
CPP      = @CPP@
CPPFLAGS = @CPPFLAGS@

LUA_INCLUDE = @LUA_INCLUDE@
LUA_LIB     = @LUA_LIB@

NSPR_CFLAGS = @NSPR_CFLAGS@
NSPR_LIBS   = @NSPR_LIBS@

NSS_CFLAGS = @NSS_CFLAGS@
NSS_LIBS   = @NSS_LIBS@

INSTALL = @INSTALL@
MKDIR_P = @MKDIR_P@
PERL    = @PERL@

include settings.mk
include main.mk

.PHONY: distclean force

distclean: clean
	@rm -rf config.log config.status Makefile configure autom4te.cache aclocal.m4

force:

initramfs: force
	rm -rf initramfs
	$(MKDIR_P) initramfs
	$(MAKE) install D=$(PWD)/initramfs
	(cd initramfs && ln -sf $(sbindir)/efup linuxrc)

initramfs.cpio: initramfs
	(cd initramfs && find . | cpio -R 0:0 -H newc -o > ../$@)

initramfs.gz: initramfs.cpio
	gzip -9 -c $< > $@
